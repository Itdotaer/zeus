<?xml version="1.0" encoding="UTF-8"?>
<entities do-package="com.ctrip.zeus.dal.core" gen="true" do-class-suffix="Do">
    <entity name="report" table="report" alias="l" do-class="ReportDo">
        <query-defs>
            <query name="find-by-group" type="SELECT">
                <param name="group-id"/>
                <statement>
                    <![CDATA[
                    SELECT <FIELDS/>
                    FROM <TABLE/>
                    WHERE <FIELD name='group-id'/> = ${group-id}
                    ]]>
                </statement>
            </query>
            <query name="find-all" type="SELECT" multiple="true">
                <statement>
                    <![CDATA[
                    SELECT <FIELDS/>
                    FROM <TABLE/>
                    WHERE current_version > reported_version
                    ]]>
                </statement>
            </query>
            <query name="update-current-version" type="UPDATE">
                <param name="group-id"/>
                <param name="current-version"/>
                <statement>
                    <![CDATA[
                    UPDATE <TABLE/>
                    SET <FIELD name='current-version'/> = ${current-version}
                    WHERE <FIELD name='group-id'/> = ${group-id}
                        AND <FIELD name='current-version'/> < ${current-version}
                    ]]>
                </statement>
            </query>
            <query name="update-reported-version" type="UPDATE">
                <param name="group-id"/>
                <param name="reported-version"/>
                <param name="status"/>
                <statement>
                    <![CDATA[
                    UPDATE <TABLE/>
                    SET <FIELD name='reported-version'/> = ${reported-version},
                        <FIELD name='status'/> = ${status}
                    WHERE <FIELD name='group-id'/> = ${group-id}
                        AND <FIELD name='reported-version'/> < ${reported-version}
                    ]]>
                </statement>
            </query>
        </query-defs>
    </entity>
</entities>

